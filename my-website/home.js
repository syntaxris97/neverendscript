const scripts = [
  {
    id: "25",
    title: "CLIMB AND JUMP TOWER Script – Tora Hub",
    description: "TORA HUB: CLIMB AND JUMP TOWER Script Pastebin 2025 AUTO FARM, AUTO WIN, BEANSTALK EVENT (NO KEY)",
    date: "2025-06-24",
    image: "image/tora240625.jpg"
  },
  {
    id: "24",
    title: "CLIMB AND JUMP TOWER Script – Polaris Hub",
    description: "POLARIS HUB: CLIMB AND JUMP TOWER Script Pastebin 2025 AUTO FARM, AUTO WIN, BEANSTALK EVENT",
    date: "2025-06-24",
    image: "image/polaris240625.jpg"
  },
  {
    id: "23",
    title: "Butterfly Hub – Blox Fruits Script",
    description: "BLOX FRUITS Script No Key UPDATE GRAVITY AUTO FARM, RAIN FRUIT, SEA EVENT, V4 DRACO (BEST TOP)",
    date: "2025-06-24",
    image: "image/butterfly240625.jpg"
  },
  {
    id: "22",
    title: "STEAL A BRAINROT Script – Dencrycode Hub",
    description: "DELFI HUB: STEAL A BRAINROT Script Pastebin 2025 INSTANT STEAL, BASE TIMER, 2X SPEED, LOCK BASE (100% EZ STEAL",
    date: "2025-06-24",
    image: "image/delfi240625.jpg"
  },
  {
    id: "21",
    title: "STEAL A BRAINROT Script – Dencrycode Hub",
    description: "DENCRYCODE HUB: STEAL A BRAINROT Script Pastebin 2025 INSTANT STEAL, NO HIT, 2X SPEED, LOCK BASE (100% EZ STEAL)",
    date: "2025-06-24",
    image: "image/Dencrycode240625.jpg"
  },
  {
    id: "20",
    title: "GROW A GARDEN Script – Lunor Hub",
    description: "LUNOR HUB: GROW A GARDEN Script Pastebin 2025 DUPLICATE SEED, PATCH?, AUTO SUMMER EVENT",
    date: "2025-06-24",
    image: "image/lunor240625.jpg"
  },
  {
    id: "19",
    title: "GROW A GARDEN Script – No Lag Hub",
    description: "NO LAG HUB: GROW A GARDEN Script",
    date: "2025-06-24",
    image: "image/nolaghub.jpg"
  },
  {
    id: "18",
    title: "Xero Kaitun Hub – Blox Fruits Script (No Key)",
    description: "BLOX FRUITS Script No Key",
    date: "2025-06-24",
    image: "image/xerohub.jpg"
  },
  {
    id: "17",
    title: "GROW A GARDEN Script – Speed Hub",
    description: "SPEED HUB: GROW A GARDEN Script",
    date: "2025-06-24",
    image: "image/speedhub.jpg"
  },
  {
    id: "16",
    title: "TxZ Hub – Blox Fruits Script",
    description: "BLOX FRUITS Script",
    date: "2025-06-19",
    image: "image/bloxfruits190620257.jpg"
  },
  {
    id: "15",
    title: "BLOX FRUITS – REDz Hub",
    description: "BLOX FRUITS Script No Key",
    date: "2025-06-19",
    image: "image/bloxfruits190620256.jpg"
  },
  {
    id: "14",
    title: "Blue X Hub Fruit Finder – Blox Fruits Script (No Key)",
    description: "BLOX FRUITS Script No Key",
    date: "2025-06-19",
    image: "image/bloxfruits1906202525.jpg"
  },
  {
    id: "13",
    title: "GROW A GARDEN Script – Pet Spawner Hub",
    description: "GROW A GARDEN Script",
    date: "2025-06-19",
    image: "image/growagarden19062025.jpg"
  },
  {
    id: "12",
    title: "Ego Hub – Blox Fruits Script",
    description: "BLOX FRUITS Script",
    date: "2025-06-19",
    image: "image/bloxfruits190620254.jpg"
  },
  {
    id: "11",
    title: "BLUE LOCK: RIVALS Script – Alchemy Hub",
    description: "BLUE LOCK: RIVALS Script",
    date: "2025-06-19",
    image: "image/bluelockrivals190620253.jpg"
  },
  {
    id: "10",
    title: "BLUE LOCK: RIVALS Script – Sterling Hub",
    description: "BLUE LOCK: RIVALS Script",
    date: "2025-06-19",
    image: "image/bluelockrivals190620252.jpg"
  },
  {
    id: "9",
    title: "BLUE LOCK: RIVALS Script – Dehism Hub",
    description: "BLUE LOCK: RIVALS Script",
    date: "2025-06-19",
    image: "image/bluelockrivals190620251.jpg"
  },
  {
    id: "8",
    title: "GROW A GARDEN Script – NAT Hub",
    description: "BLOX FRUITS Script No Key",
    date: "2025-06-17",
    image: "image/nathub17.jpg"
  },
  {
    id: "7",
    title: "Vxeze Hub Fruit Finder – Blox Fruits Script (No Key)",
    description: "BLOX FRUITS Script No Key",
    date: "2025-06-15",
    image: "image/fruitfinder.jpg"
  },
  {
    id: "6",
    title: "GROW A GARDEN Script – Lunor Hub",
    description: "LUNOR HUB: GROW A GARDEN Script",
    date: "2025-06-15",
    image: "image/lunorhub.jpg"
  },
  {
    id: "5",
    title: "GROW A GARDEN Script – No Lag Hub",
    description: "NO LAG HUB: GROW A GARDEN Script",
    date: "2025-06-15",
    image: "image/nolaghub.jpg"
  },
  {
    id: "4",
    title: "GROW A GARDEN Script – Speed Hub",
    description: "SPEED HUB: GROW A GARDEN Script",
    date: "2025-06-15",
    image: "image/speedhub.jpg"
  },
  {
    id: "3",
    title: "Xero Hub – Blox Fruits Script (No Key)",
    description: "BLOX FRUITS Script No Key",
    date: "2025-06-14",
    image: "image/xerohub.jpg"
  },
  {
    id: "2",
    title: "DEAD RAILS Script – Skull Hub",
    description: "SKULL HUB: DEAD RAILS Script",
    date: "2025-06-14",
    image: "image/nathub2.jpg"
  },
  {
    id: "1",
    title: "DEAD RAILS Script – Nat Hub",
    description: "NAT HUB: DEAD RAILS Script",
    date: "2025-06-14",
    image: "image/nathub.jpg"
  }
];

const executors = [
  {
    id: "7",
    title: "TRIGON Executor",
    description: "Popular and reliable Roblox script executor.",
    date: "2025-06-17",
    image: "image/trigon617.jpg"
  },
  {
    id: "6",
    title: "DELTA Executor",
    description: "Popular and reliable Roblox script executor.",
    date: "2025-06-17",
    image: "image/deltaexe.jpg"
  },
  {
    id: "5",
    title: "VEGA X Executor",
    description: "Popular and reliable Roblox script executor.",
    date: "2025-06-17",
    image: "image/vegaxexe.jpg"
  },
  {
    id: "4",
    title: "CODEX Executor",
    description: "Popular and reliable Roblox script executor.",
    date: "2025-06-17",
    image: "image/codexexe.jpg"
  },
  {
    id: "1",
    title: "CRYPTIC Executor",
    description: "Popular and reliable Roblox script executor.",
    date: "2025-06-17",
    image: "image/crypticexe.jpg"
  },
  {
    id: "3",
    title: "KRNL Executor",
    description: "Free executor with wide script support.",
    date: "2025-06-17",
    image: "image/krnlexe.jpg"
  },
  {
    id: "2",
    title: "FLUXUS Executor",
    description: "Fast and feature-rich Roblox executor.",
    date: "2025-06-10",
    image: "image/fluxusexe.jpg"
  }
];

const itemsPerPage = 3;
let searchResults = [];
let selectedIndex = -1;

function renderCards(data, containerId, page, type) {
  const container = document.getElementById(containerId);
  container.innerHTML = "";

  const start = (page - 1) * itemsPerPage;
  const end = start + itemsPerPage;
  const pageItems = data.slice(start, end);

  pageItems.forEach((item, index) => {
    const card = document.createElement("div");
    card.className = "card";
    card.setAttribute("data-index", index);
    card.innerHTML = `
      <img src="${item.image}" alt="${item.title}" />
      <h3>${item.title}</h3>
      <small>${item.date}</small>
      <p>${item.description}</p>
    `;

    if (type === "script") {
      card.addEventListener("click", () => {
        const url = `script.html?id=${encodeURIComponent(item.id)}`;
        window.location.href = url;
      });
    } else if (type === "executor") {
      card.addEventListener("click", () => {
        const url = `executor.html?id=${encodeURIComponent(item.id)}`;
        window.location.href = url;
      });
    }

    container.appendChild(card);
  });
}

function renderPagination(data, paginationId, changePageFunc) {
  const totalPages = Math.ceil(data.length / itemsPerPage);
  const pagination = document.getElementById(paginationId);
  pagination.innerHTML = "";

  for (let i = 1; i <= totalPages; i++) {
    const btn = document.createElement("button");
    btn.textContent = i;
    btn.addEventListener("click", () => changePageFunc(i));
    pagination.appendChild(btn);
  }
}

function updateActivePagination(paginationId, activePage) {
  const buttons = document.getElementById(paginationId).querySelectorAll("button");
  buttons.forEach((btn, index) => {
    btn.classList.toggle("active", index + 1 === activePage);
  });
}

function changeScriptPage(page) {
  renderCards(scripts, "scriptCards", page, "script");
  renderPagination(scripts, "scriptPagination", changeScriptPage);
  updateActivePagination("scriptPagination", page);
}

function changeExecutorPage(page) {
  renderCards(executors, "executorCards", page, "executor");
  renderPagination(executors, "executorPagination", changeExecutorPage);
  updateActivePagination("executorPagination", page);
}

function showSection(section) {
  const scriptsSection = document.getElementById("scriptsSection");
  const executorsSection = document.getElementById("executorsSection");

  scriptsSection.style.display = section === "home" || section === "scripts" ? "block" : "none";
  executorsSection.style.display = section === "home" || section === "executors" ? "block" : "none";

  document.querySelectorAll("nav ul a").forEach(link => link.classList.remove("active"));
  const navLink = document.getElementById("nav" + section.charAt(0).toUpperCase() + section.slice(1));
  if (navLink) navLink.classList.add("active");
}

function highlightResult(index) {
  const allCards = document.querySelectorAll(".card");
  allCards.forEach((card, i) => {
    card.style.outline = i === index ? "2px solid #007bff" : "none";
  });
}

function liveSearch() {
  const query = document.getElementById("searchInput").value.toLowerCase();
  selectedIndex = -1;

  const filteredScripts = scripts.filter(s =>
    s.title.toLowerCase().includes(query) || s.description.toLowerCase().includes(query)
  );
  const filteredExecutors = executors.filter(e =>
    e.title.toLowerCase().includes(query) || e.description.toLowerCase().includes(query)
  );

  searchResults = [...filteredScripts, ...filteredExecutors];

  if (query === "") {
    showSection("home");
    changeScriptPage(1);
    changeExecutorPage(1);
  } else if (filteredScripts.length > 0) {
    showSection("scripts");
    renderCards(filteredScripts, "scriptCards", 1, "script");
    document.getElementById("scriptPagination").innerHTML = "";
  } else if (filteredExecutors.length > 0) {
    showSection("executors");
    renderCards(filteredExecutors, "executorCards", 1, "executor");
    document.getElementById("executorPagination").innerHTML = "";
  } else {
    document.getElementById("scriptCards").innerHTML = "<p>No scripts found.</p>";
    document.getElementById("executorCards").innerHTML = "<p>No executors found.</p>";
    document.getElementById("scriptPagination").innerHTML = "";
    document.getElementById("executorPagination").innerHTML = "";
  }
}

document.getElementById("searchInput").addEventListener("input", liveSearch);

document.getElementById("searchInput").addEventListener("keydown", (e) => {
  if (searchResults.length === 0) return;

  const cards = document.querySelectorAll(".card");

  if (e.key === "ArrowDown") {
    e.preventDefault();
    selectedIndex = (selectedIndex + 1) % cards.length;
    highlightResult(selectedIndex);
  }

  if (e.key === "ArrowUp") {
    e.preventDefault();
    selectedIndex = (selectedIndex - 1 + cards.length) % cards.length;
    highlightResult(selectedIndex);
  }

  if (e.key === "Enter" && selectedIndex !== -1) {
    const selectedCard = cards[selectedIndex];
    selectedCard.scrollIntoView({ behavior: "smooth", block: "center" });
    selectedCard.style.background = "#e6f0ff";
    setTimeout(() => selectedCard.style.background = "", 800);
  }
});

// Theme toggle
const themeToggle = document.getElementById("themeToggle");
const body = document.body;
const savedTheme = localStorage.getItem("theme");
if (savedTheme === "dark") {
  body.classList.add("dark");
  themeToggle.textContent = "☀️ Light Mode";
}
themeToggle.addEventListener("click", () => {
  body.classList.toggle("dark");
  const isDark = body.classList.contains("dark");
  themeToggle.textContent = isDark ? "☀️ Light Mode" : "🌙 Dark Mode";
  localStorage.setItem("theme", isDark ? "dark" : "light");
});

// Navbar events
document.getElementById("navScripts").addEventListener("click", (e) => {
  e.preventDefault();
  showSection("scripts");
  changeScriptPage(1);
});
document.getElementById("navExecutors").addEventListener("click", (e) => {
  e.preventDefault();
  showSection("executors");
  changeExecutorPage(1);
});
document.getElementById("navHome").addEventListener("click", (e) => {
  e.preventDefault();
  showSection("home");
  changeScriptPage(1);
  changeExecutorPage(1);
});

// Initial load
window.onload = () => {
  showSection("home");
  changeScriptPage(1);
  renderPagination(scripts, "scriptPagination", changeScriptPage);
  changeExecutorPage(1);
  renderPagination(executors, "executorPagination", changeExecutorPage);
};
